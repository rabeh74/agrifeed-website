{% extends 'store/base.html' %}

{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ #{{ order.id }} - Agree Feed{% endblock %}

{% block content %}
<div style="margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
    <a href="{% url 'store:order_list' %}" class="btn btn-secondary">
        <span>â†</span> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø·Ù„Ø¨Ø§Øª
    </a>
    <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
        <a href="{% url 'store:edit_order' order.id %}" class="btn">
            <span>âœï¸</span> ØªØ¹Ø¯ÙŠÙ„
        </a>
        <a href="{% url 'store:delete_order' order.id %}" class="btn btn-danger">
            <span>ğŸ—‘ï¸</span> Ø­Ø°Ù
        </a>
    </div>
</div>

<div class="grid" style="grid-template-columns: 1fr 1.5fr; gap: 1.5rem; align-items: start;">
    <!-- Order Info Card -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title" style="display: flex; align-items: center; justify-content: space-between;">
                <span><span>ğŸ“‹</span> Ø§Ù„Ø·Ù„Ø¨ #{{ order.id }}</span>
                <span class="badge badge-{{ order.status }}" style="font-size: 0.875rem;">
                    {% if order.status == 'completed' %}
                        âœ“ Ù…ÙƒØªÙ…Ù„
                    {% else %}
                        âœ• Ù…Ù„ØºÙŠ
                    {% endif %}
                </span>
            </h2>
        </div>

        <div>
            <h3 style="font-size: 1.125rem; margin-bottom: 1rem; color: var(--text-secondary); display: flex; align-items: center; gap: 0.5rem;">
                <span>ğŸ‘¤</span> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
            </h3>

            <div class="info-row">
                <span class="info-label">Ø§Ù„Ø§Ø³Ù…:</span>
                <span class="info-value"><strong>{{ order.customer_name }}</strong></span>
            </div>

            <div class="info-row">
                <span class="info-label">Ø§Ù„Ø¨Ø±ÙŠØ¯:</span>
                <span class="info-value">{{ order.customer_email }}</span>
            </div>

            <div class="info-row">
                <span class="info-label">Ø§Ù„Ù‡Ø§ØªÙ:</span>
                <span class="info-value" style="direction: ltr; text-align: left;">{{ order.customer_phone }}</span>
            </div>

            <div class="info-row">
                <span class="info-label">Ø§Ù„ØªØ§Ø±ÙŠØ®:</span>
                <span class="info-value">{{ order.created_at|date:"Y/m/d - H:i" }}</span>
            </div>

            {% if order.notes %}
            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid var(--gray-100);">
                <h4 style="font-size: 0.95rem; margin-bottom: 0.5rem; color: var(--text-secondary); display: flex; align-items: center; gap: 0.5rem;">
                    <span>ğŸ“</span> Ù…Ù„Ø§Ø­Ø¸Ø§Øª
                </h4>
                <p style="color: var(--text-primary); background: var(--gray-50); padding: 1rem; border-radius: var(--border-radius); line-height: 1.6;">
                    {{ order.notes }}
                </p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Order Items Card -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title" style="font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;">
                <span>ğŸ“¦</span> Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            </h3>
        </div>

        {% if order_items %}
        <div style="overflow-x: auto;">
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                        <th>Ø§Ù„Ø³Ø¹Ø±</th>
                        <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                        <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order_items %}
                    <tr>
                        <td>
                            <strong style="color: var(--text-primary);">{{ item.product.name }}</strong>
                        </td>
                        <td>
                            <span style="color: var(--text-secondary);">{{ item.price }} Ø¬.Ù…</span>
                        </td>
                        <td>
                            <span class="badge badge-completed" style="font-size: 0.875rem;">
                                {{ item.quantity }}
                            </span>
                        </td>
                        <td>
                            <span class="price" style="font-size: 1rem;">{{ item.get_total_price }} Ø¬.Ù…</span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Total Section -->
        <div style="margin-top: 1.5rem; padding: 1.5rem; background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%); border-radius: var(--border-radius); text-align: center;">
            <div style="color: rgba(255,255,255,0.9); font-size: 0.95rem; margin-bottom: 0.5rem; font-weight: 600;">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
            <div style="color: white; font-size: 2rem; font-weight: 700;">{{ total_price }} Ø¬.Ù…</div>
        </div>
        {% else %}
        <div class="empty-state">
            <div class="empty-state-icon">ğŸ“¦</div>
            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨</p>
        </div>
        {% endif %}
    </div>
</div>

<!-- Order Timeline -->
<div class="card">
    <h3 style="font-size: 1.125rem; margin-bottom: 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
        <span>â±ï¸</span> Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨
    </h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div style="padding: 1rem; background: var(--gray-50); border-radius: var(--border-radius); border-right: 3px solid var(--success-color);">
            <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</div>
            <div style="font-weight: 600; color: var(--text-primary);">{{ order.created_at|date:"Y/m/d - H:i" }}</div>
        </div>
        <div style="padding: 1rem; background: var(--gray-50); border-radius: var(--border-radius); border-right: 3px solid var(--info-color);">
            <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</div>
            <div style="font-weight: 600; color: var(--text-primary);">{{ order.updated_at|date:"Y/m/d - H:i" }}</div>
        </div>
        <div style="padding: 1rem; background: var(--gray-50); border-radius: var(--border-radius); border-right: 3px solid var(--warning-color);">
            <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
            <div style="font-weight: 600; color: var(--text-primary);">{{ order_items.count }} Ù…Ù†ØªØ¬</div>
        </div>
    </div>
</div>

{% block extra_css %}
<style>
    @media (max-width: 968px) {
        .grid {
            grid-template-columns: 1fr !important;
        }
    }
</style>
{% endblock %}
{% endblock %}
