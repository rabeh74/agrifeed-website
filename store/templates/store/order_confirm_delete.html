{% extends 'store/base.html' %}

{% block title %}حذف الطلب #{{ order.id }} - Agree Feed{% endblock %}

{% block content %}
<div style="margin-bottom: 20px;">
    <a href="{% url 'store:order_detail' order.id %}" class="btn">← العودة لتفاصيل الطلب</a>
</div>

<div class="card" style="max-width: 700px; margin: 0 auto;">
    <h2 style="margin-bottom: 25px; color: #e74c3c;">⚠️ تأكيد حذف الطلب</h2>

    <div class="alert alert-error" style="margin-bottom: 25px;">
        <strong>تحذير:</strong> سيتم حذف هذا الطلب وإعادة المخزون إلى المنتجات. هذا الإجراء لا يمكن التراجع عنه!
    </div>

    <div style="background: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 25px;">
        <h3 style="margin-bottom: 15px; color: #2c3e50;">الطلب #{{ order.id }}</h3>

        <div style="margin-bottom: 15px;">
            <div class="info-row">
                <span class="info-label">العميل:</span>
                <span>{{ order.customer_name }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">الهاتف:</span>
                <span>{{ order.customer_phone }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">الحالة:</span>
                <span class="badge badge-{{ order.status }}">
                    {% if order.status == 'pending' %}قيد الانتظار
                    {% elif order.status == 'processing' %}قيد المعالجة
                    {% elif order.status == 'completed' %}مكتمل
                    {% else %}ملغي{% endif %}
                </span>
            </div>
            <div class="info-row">
                <span class="info-label">المنتجات:</span>
                <span>{{ order.items.count }} منتج</span>
            </div>
            <div class="info-row">
                <span class="info-label">الإجمالي:</span>
                <span class="price">{{ total_price }} ج.م</span>
            </div>
        </div>
    </div>

    <div style="background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; padding: 15px; border-radius: 5px; margin-bottom: 25px;">
        <strong>ℹ️ ملاحظة:</strong> سيتم إعادة الكميات التالية إلى المخزون:
        <ul style="margin: 10px 0 0 20px;">
            {% for item in order.items.all %}
            <li>{{ item.product.name }}: {{ item.quantity }} وحدة</li>
            {% endfor %}
        </ul>
    </div>

    <p style="margin-bottom: 25px; color: #666;">
        هل أنت متأكد من حذف هذا الطلب؟
    </p>

    <form method="post">
        {% csrf_token %}
        <div style="display: flex; gap: 10px;">
            <button type="submit" class="btn btn-danger" style="flex: 1;">نعم، احذف الطلب</button>
            <a href="{% url 'store:order_detail' order.id %}" class="btn" style="flex: 1; text-align: center; line-height: 38px;">إلغاء</a>
        </div>
    </form>
</div>
{% endblock %}
