{% extends 'store/base.html' %}

{% block title %}ุงูุนููุงุก - Agree Feed{% endblock %}

{% block content %}
<div class="page-header">
    <h2><span>๐ฅ</span> ูุงุฆูุฉ ุงูุนููุงุก</h2>
    <a href="{% url 'store:customer_create' %}" class="btn btn-success">
        <span>โ</span> ุนููู ุฌุฏูุฏ
    </a>
</div>

<!-- Search Section -->
<div class="card">
    <form method="get" action="{% url 'store:customer_list' %}">
        <div class="grid grid-3">
            <!-- Search Box -->
            <div class="form-group" style="margin-bottom: 0;">
                <label>๐ ุจุญุซ</label>
                <input type="text" name="search" class="form-control" placeholder="ุงุจุญุซ ุจุงุณู ุงูุนููู ุฃู ุงููุงุชู..." value="{{ search_query }}">
            </div>

            <!-- Sort By -->
            <div class="form-group" style="margin-bottom: 0;">
                <label>๐ ุชุฑุชูุจ ุญุณุจ</label>
                <select name="sort" class="form-control">
                    <option value="full_name" {% if sort_by == 'full_name' %}selected{% endif %}>ุงูุงุณู (ุฃ-ู)</option>
                    <option value="-full_name" {% if sort_by == '-full_name' %}selected{% endif %}>ุงูุงุณู (ู-ุฃ)</option>
                    <option value="-created_at" {% if sort_by == '-created_at' %}selected{% endif %}>ุงูุฃุญุฏุซ</option>
                    <option value="created_at" {% if sort_by == 'created_at' %}selected{% endif %}>ุงูุฃูุฏู</option>
                </select>
            </div>

            <!-- Submit Button -->
            <div style="display: flex; align-items: flex-end;">
                <button type="submit" class="btn" style="width: 100%;">
                    <span>๐</span> ุชุทุจูู
                </button>
            </div>
        </div>
    </form>
</div>

<!-- Customers Count -->
{% if search_query %}
<div class="card" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-right: 4px solid #3b82f6;">
    <p style="margin: 0; color: #1e40af; font-weight: 600;">
        <span>โน๏ธ</span> ุชู ุงูุนุซูุฑ ุนูู {{ customers.count }} ุนููู ูู ูุชุงุฆุฌ ุงูุจุญุซ ุนู "{{ search_query }}"
    </p>
</div>
{% endif %}

{% if customers %}
<div class="table-container">
    <table>
        <thead>
            <tr>
                <th><span>๐ค</span> ุงูุงุณู ุงููุงูู</th>
                <th><span>๐ฑ</span> ุฑูู ุงููุงุชู</th>
                <th><span>๐ฐ</span> ุฅุฌูุงูู ุงูุฏููู</th>
                <th><span>๐</span> ุนุฏุฏ ุงูุทูุจุงุช</th>
                <th><span>๐</span> ุชุงุฑูุฎ ุงูุฅุถุงูุฉ</th>
                <th><span>โ๏ธ</span> ุงูุฅุฌุฑุงุกุงุช</th>
            </tr>
        </thead>
        <tbody>
            {% for customer in customers %}
            <tr>
                <td><strong>{{ customer.full_name }}</strong></td>
                <td style="direction: ltr; text-align: right;">{{ customer.phone_number|default:"-" }}</td>
                <td>
                    <span class="price" style="color: {% if customer.get_total_debt > 0 %}var(--danger-color){% else %}var(--success-color){% endif %}; font-weight: 700;">
                        {{ customer.get_total_debt }} ุฌ.ู
                    </span>
                </td>
                <td>
                    <span class="badge badge-completed">{{ customer.orders.count }}</span>
                </td>
                <td>{{ customer.created_at|date:"Y/m/d" }}</td>
                <td>
                    <a href="{% url 'store:customer_detail' customer.id %}" class="btn btn-sm">
                        <span>๐๏ธ</span> ุนุฑุถ
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card empty-state">
    <div class="empty-state-icon">๐ฅ</div>
    <h3>ูุง ููุฌุฏ ุนููุงุก</h3>
    <p>
        {% if search_query %}
            ูู ูุชู ุงูุนุซูุฑ ุนูู ุนููุงุก ุชุทุงุจู ุจุญุซู ุนู "{{ search_query }}"
        {% else %}
            ูุง ููุฌุฏ ุนููุงุก ุญุงููุงู ูู ุงููุธุงู
        {% endif %}
    </p>
    {% if search_query %}
        <a href="{% url 'store:customer_list' %}" class="btn">
            <span>โป</span> ุนุฑุถ ุฌููุน ุงูุนููุงุก
        </a>
    {% else %}
        <a href="{% url 'store:customer_create' %}" class="btn btn-success">
            <span>โ</span> ุฅุถุงูุฉ ุฃูู ุนููู
        </a>
    {% endif %}
</div>
{% endif %}
{% endblock %}

