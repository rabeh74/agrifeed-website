{% extends 'store/base.html' %}

{% block title %}Ø§Ù„Ø·Ù„Ø¨Ø§Øª - Agree Feed{% endblock %}

{% block content %}
<div class="page-header">
    <h2><span>ğŸ“‹</span> Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
    <a href="{% url 'store:create_order' %}" class="btn btn-success">
        <span>ğŸ›’</span> Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
    </a>
</div>

<!-- Search and Filter Section -->
<div class="card">
    <form method="get" action="{% url 'store:order_list' %}">
        <div class="grid grid-4">
            <!-- Search Box -->
            <div class="form-group" style="margin-bottom: 0;">
                <label>ğŸ” Ø¨Ø­Ø«</label>
                <input type="text" name="search" class="form-control" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ù‡Ø§ØªÙ..." value="{{ search_query }}">
            </div>

            <!-- Status Filter -->
            <div class="form-group" style="margin-bottom: 0;">
                <label>ğŸ“Š Ø§Ù„Ø­Ø§Ù„Ø©</label>
                <select name="status" class="form-control">
                    <option value="all" {% if status_filter == 'all' %}selected{% endif %}>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                    <option value="completed" {% if status_filter == 'completed' %}selected{% endif %}>Ù…ÙƒØªÙ…Ù„</option>
                    <option value="cancelled" {% if status_filter == 'cancelled' %}selected{% endif %}>Ù…Ù„ØºÙŠ</option>
                </select>
            </div>

            <!-- Date Filter -->
            <div class="form-group" style="margin-bottom: 0;">
                <label>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                <select name="date" class="form-control">
                    <option value="all" {% if date_filter == 'all' %}selected{% endif %}>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª</option>
                    <option value="today" {% if date_filter == 'today' %}selected{% endif %}>Ø§Ù„ÙŠÙˆÙ…</option>
                    <option value="week" {% if date_filter == 'week' %}selected{% endif %}>Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
                    <option value="month" {% if date_filter == 'month' %}selected{% endif %}>Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</option>
                </select>
            </div>

            <!-- Submit Button -->
            <div style="display: flex; align-items: flex-end;">
                <button type="submit" class="btn" style="width: 100%;">
                    <span>ğŸ”</span> ØªØ·Ø¨ÙŠÙ‚
                </button>
            </div>
        </div>
    </form>
</div>

<!-- Orders Count -->
{% if search_query or status_filter != 'all' or date_filter != 'all' %}
<div class="card" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-right: 4px solid #3b82f6;">
    <p style="margin: 0; color: #1e40af; font-weight: 600;">
        <span>â„¹ï¸</span> ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ {{ orders.count }} Ø·Ù„Ø¨
        {% if search_query %} ÙÙŠ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† "{{ search_query }}"{% endif %}
    </p>
</div>
{% endif %}

{% if orders %}
<div class="table-container">
    <table>
        <thead>
            <tr>
                <th><span>ğŸ”¢</span> Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                <th><span>ğŸ‘¤</span> Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                <th><span>ğŸ“±</span> Ø§Ù„Ù‡Ø§ØªÙ</th>
                <th><span>ğŸ“Š</span> Ø§Ù„Ø­Ø§Ù„Ø©</th>
                <th><span>ğŸ’°</span> Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                <th><span>ğŸ“…</span> Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                <th><span>âš™ï¸</span> Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td><strong style="color: var(--primary-color);">#{{ order.id }}</strong></td>
                <td><strong>{{ order.customer_name }}</strong></td>
                <td style="direction: ltr; text-align: right;">{{ order.customer_phone }}</td>
                <td>
                    <span class="badge badge-{{ order.status }}">
                        {% if order.status == 'completed' %}
                            âœ“ Ù…ÙƒØªÙ…Ù„
                        {% else %}
                            âœ• Ù…Ù„ØºÙŠ
                        {% endif %}
                    </span>
                </td>
                <td><span class="price">{{ order.get_total_price }} Ø¬.Ù…</span></td>
                <td>{{ order.created_at|date:"Y/m/d - H:i" }}</td>
                <td>
                    <a href="{% url 'store:order_detail' order.id %}" class="btn btn-sm">
                        <span>ğŸ‘ï¸</span> Ø¹Ø±Ø¶
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card empty-state">
    <div class="empty-state-icon">ğŸ“‹</div>
    <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</h3>
    <p>
        {% if search_query %}
            Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ø¨Ø­Ø«Ùƒ Ø¹Ù† "{{ search_query }}"
        {% else %}
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
        {% endif %}
    </p>
    {% if search_query %}
        <a href="{% url 'store:order_list' %}" class="btn">
            <span>â†»</span> Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        </a>
    {% else %}
        <a href="{% url 'store:create_order' %}" class="btn btn-success">
            <span>ğŸ›’</span> Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙˆÙ„ Ø·Ù„Ø¨
        </a>
    {% endif %}
</div>
{% endif %}
{% endblock %}
